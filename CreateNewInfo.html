<!DOCTYPE html>
<html lang="ko">
<head>
    <title id="titleCheck">CreateNew2</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    
</head>
<body>
    <div ckass="container">
        <nav class="navbar nav-pills navbar-expand-sm bg-light">
            <img class="navbar-brand" src="./img/logo.png">
        </nav>
    </div>

    <div class="container">
        <div class="row my-row">
            <div class="col my-col">
                <br>
            </div>

        </div>
        <div class="row my-rowone">
            <div class="col-6">
                <div class="form-group">
                    <label for="ID">ID :</label>
                    <input type="text" class="form-control" id="id">
                </div>
                <div class="form-group">
                    <label for="pwd">PASS :</label>
                    <input type="password" class="form-control" id="pwd">
                </div>
                <div class="form-group">
                    <label for="phone">Phone :</label>
                    <input type="text" class="form-control" id="phone">
                </div>
            </div>
            <div class="col-6">
                <div class="form-group">
                    <label for="email">E-mail :</label>
                    <input type="email" class="form-control" id="email">
                </div>
                <div class="form-group">
                    <label for="pwdc">PASS CONFIRM :</label>
                    <input type="password" class="form-control" id="passconfirm">
                </div>
                <div class="form-group">
                    <label for="email">Name :</label>
                    <input type="text" class="form-control" id="name">
                </div>
            </div>
        </div>
        <div class="row my-rowone">
            <div class="col-12">
                <div class="form-group">
                    <label for="email">Address :</label>
                    <input type="text" class="form-control" id="address1">
                    <input type="text" class="form-control" id="address2">
                </div>
            </div>
            <div class="col-12">
                <div class="row my-row">
                    <div class="col my-col">
                        <button type="button" class="btn btn-primary float-right mx-1 join">가입</button>
                        <a href="./CreateNew.html" type="button" class="btn btn-primary float-right mx-1" role="button">뒤로</a>
                    </div>
                </div>
            </div>
        </div>



        <script src="https://www.gstatic.com/firebasejs/5.10.1/firebase.js"></script>
        <script>
            // Initialize Firebase
            var config = {
                apiKey: "AIzaSyBW7PQLFz7-cTpX-V2lmKE5JlqfwfSDCXs",
                authDomain: "dentwebdata.firebaseapp.com",
                databaseURL: "https://dentwebdata.firebaseio.com",
                projectId: "dentwebdata",
                storageBucket: "dentwebdata.appspot.com",
                messagingSenderId: "349793546675"
            };
            firebase.initializeApp(config);
            var database = firebase.database();

            //버튼기능
            $(document).ready(function(){
                $(document).on('click', '.join', function () {
                    var id = $('#id').val();
                    var email = $('#email').val();
                    var password = $('#pwd').val();
                    var passwordconfirm = $('#passconfirm').val();
                    var phone = $('#phone').val();
                    var name = $('#name').val();
                    var address1 = $('#address1').val();
                    var address2 = $('#address2').val();

                    //개인 데이터베스 선행구축
                    var Ahospit = {
                        hospitname: '고려대학교병원',
                        hospitcmpynum: '198362',
                        hospitprname: '홍길동',
                        hospitaddress: '서울 성북구 인촌로 73',
                        hospitphonenum: '15770083',
                        hospittradestatus: '1',
                    };
                    var Ahospitcustumer = {
                        age: '52',
                        name: '이한실',
                        duedate: '20190812',
                        shipmentstatus: '3',
                    };
                    var Bcompany = {
                        companyname: 'A기업',
                        companycmpynum: '192732',
                        companyprname: '이민규',
                        companyaddress: '서울 성북고 안암로 31',
                        companyphonenum: '02-953-1853',
                    };
                    


                    firebase.auth().createUserWithEmailAndPassword(email, password).catch(function (error) {
                        var errorCode = error.code;
                        var errorMessage = error.message;
                        alert(errorCode + errorMessage);
                    });
                    firebase.auth().onAuthStateChanged(function (user) {
                        if (user) {
                            var obj = {
                                userid: id,
                                useremail: email,
                                userphone: phone,
                                name: name,
                                useraddress: address1+address2,
                                userkey: user.uid,
                            };
                            firebase.database().ref('users/' + user.uid).update(obj);
                            firebase.database().ref('users/' + user.uid + '/Ahospit').update(Ahospit);
                            firebase.database().ref('users/' + user.uid + '/Ahospit/Ahospitcustumer').update(Ahospitcustumer);
                            firebase.database().ref('users/' + user.uid + '/Bcompany').update(Bcompany);

                            alert("가입성공");
                            firebase.auth().signOut()
                            window.location.href = "./index.html"
                        } else {
                        }
                    });
                });
            });
        </script>










        <!--
     <form class="form-inline" action="/action_page.php">

     </form>
     <form class="form-inline" action="/action_page.php">
     </form>
     <form class="form-inline" action="/action_page.php">
     </form>
     <form class="form-inline" action="/action_page.php">
     </form>
         <button type="button" class="btn btn-primary float-right mx-1">다음</button>
         <button type="button" class="btn btn-primary float-right mx-1">뒤로</button>
    -->

</body>
</html>